<main class="auth-page">
    <section class="auth-container" aria-labelledby="signup-title">
      <header class="auth-header">
        <h1 id="signup-title">Criar conta</h1>
        <p>Cadastre-se para começar a gerenciar seus contatos.</p>
      </header>
  
      <mat-card class="auth-card" role="form">
        <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
          <section aria-label="Dados pessoais">
            <div class="form-group">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Nome completo</mat-label>
                <input
                  matInput
                  type="text"
                  formControlName="name"
                  autocomplete="name"
                  required
                  aria-required="true"
                />
                <mat-error *ngIf="name?.hasError('required')">
                  Nome é obrigatório.
                </mat-error>
                <mat-error *ngIf="name?.hasError('minlength') && !name?.hasError('required')">
                  Nome deve ter pelo menos 3 caracteres.
                </mat-error>
              </mat-form-field>
            </div>
  
            <div class="form-group">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>E-mail</mat-label>
                <input
                  matInput
                  type="email"
                  formControlName="email"
                  autocomplete="email"
                  required
                  aria-required="true"
                />
                <mat-error *ngIf="email?.hasError('required')">
                  E-mail é obrigatório.
                </mat-error>
                <mat-error *ngIf="email?.hasError('email') && !email?.hasError('required')">
                  Informe um e-mail válido.
                </mat-error>
                <mat-error *ngIf="emailError">
                  {{ emailError }}
                </mat-error>
              </mat-form-field>
            </div>
          </section>
  
          <section aria-label="Definição de senha">
            <div class="form-group">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Senha</mat-label>
                <input
                  matInput
                  [type]="hidePassword ? 'password' : 'text'"
                  formControlName="password"
                  autocomplete="new-password"
                  required
                  aria-required="true"
                />
                <button
                  mat-icon-button
                  matSuffix
                  type="button"
                  (click)="hidePassword = !hidePassword"
                  [attr.aria-label]="hidePassword ? 'Mostrar senha' : 'Ocultar senha'"
                  [attr.aria-pressed]="!hidePassword"
                >
                  <mat-icon>{{ hidePassword ? 'visibility' : 'visibility_off' }}</mat-icon>
                </button>
                <mat-error *ngIf="password?.hasError('required')">
                  Senha é obrigatória.
                </mat-error>
                <mat-error *ngIf="password?.hasError('minlength') && !password?.hasError('required')">
                  Senha deve ter pelo menos 6 caracteres.
                </mat-error>
              </mat-form-field>
            </div>
  
            <div class="form-group">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Confirmar senha</mat-label>
                <input
                  matInput
                  [type]="hideConfirmPassword ? 'password' : 'text'"
                  formControlName="confirmPassword"
                  autocomplete="new-password"
                  required
                  aria-required="true"
                />
                <button
                  mat-icon-button
                  matSuffix
                  type="button"
                  (click)="hideConfirmPassword = !hideConfirmPassword"
                  [attr.aria-label]="hideConfirmPassword ? 'Mostrar confirmação de senha' : 'Ocultar confirmação de senha'"
                  [attr.aria-pressed]="!hideConfirmPassword"
                >
                  <mat-icon>{{ hideConfirmPassword ? 'visibility' : 'visibility_off' }}</mat-icon>
                </button>
                <mat-error *ngIf="confirmPassword?.hasError('required')">
                  Confirmação de senha é obrigatória.
                </mat-error>
                <mat-error *ngIf="hasPasswordMismatch()">
                  As senhas não coincidem.
                </mat-error>
              </mat-form-field>
            </div>
          </section>
  
          <section class="auth-error" *ngIf="genericError">
            <p role="alert">{{ genericError }}</p>
          </section>
  
          <section class="auth-actions">
            <button
              mat-raised-button
              color="primary"
              type="submit"
              [disabled]="loading"
            >
              <span *ngIf="!loading">Criar conta</span>
              <mat-progress-spinner
                *ngIf="loading"
                mode="indeterminate"
                diameter="20"
              ></mat-progress-spinner>
            </button>
          </section>
  
          <footer class="auth-footer">
            <p>
              Já tem conta?
              <a routerLink="/auth/login">Entrar</a>
            </p>
          </footer>
        </form>
      </mat-card>
    </section>
  </main>
  